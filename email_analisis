import subprocess
import requests
from googlesearch import search

def banner():
    print("""
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        ğŸ•µï¸ OSINT EMAIL ANALYZER TOOL         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    """)

def check_holehe(email):
    print("\nğŸ” [1] Comprobando presencia en plataformas (holehe)...")
    try:
        subprocess.run(["holehe", email], check=True)
    except Exception as e:
        print(f"âš ï¸ Error ejecutando holehe: {e}")

def check_emailrep(email):
    print("\nğŸ” [2] ReputaciÃ³n y metadata (emailrep.io)...")
    try:
        r = requests.get(f"https://emailrep.io/{email}", headers={"User-Agent": "osint-analyzer"})
        if r.status_code == 200:
            data = r.json()
            print(f"âœ… ReputaciÃ³n: {data.get('reputation')}")
            print(f"ğŸ“¡ Dominio: {data.get('domain')}")
            print(f"ğŸ§¬ Detectado en leaks: {data['details'].get('data_breach')}")
            print(f"ğŸŒ Redes sociales asociadas: {data['details'].get('profiles')}")
        else:
            print(f"âš ï¸ EmailRep respondiÃ³: {r.status_code}")
    except Exception as e:
        print(f"âŒ Error con emailrep: {e}")

def check_pwned(email):
    print("\nğŸ’¥ [3] Filtraciones conocidas (HaveIBeenPwned)...")
    try:
        headers = {"User-Agent": "osint-analyzer"}
        r = requests.get(f"https://haveibeenpwned.com/api/v3/breachedaccount/{email}", headers=headers)
        if r.status_code == 200:
            breaches = r.json()
            print(f"âœ… Aparece en {len(breaches)} filtraciones:")
            for b in breaches:
                print(f" - {b['Name']}")
        elif r.status_code == 404:
            print("âœ… El correo NO aparece en breaches pÃºblicos conocidos.")
        else:
            print(f"âš ï¸ HaveIBeenPwned respondiÃ³: {r.status_code}")
    except Exception as e:
        print(f"âŒ Error con HaveIBeenPwned: {e}")

def google_dorks(email):
    print("\nğŸŒ [4] Resultados pÃºblicos en Google...")
    dork = f'"{email}"'
    try:
        results = list(search(dork, num_results=10, lang="es"))
        for link in results:
            print(f"ğŸ”— {link}")
    except Exception as e:
        print(f"âš ï¸ Google bloqueÃ³ la bÃºsqueda o dio error: {e}")

# ============================ MAIN ============================

banner()
email = input("ğŸ“§ Ingresa el correo completo: ").strip()

check_holehe(email)
check_emailrep(email)
check_pwned(email)
google_dorks(email)

print("\nâœ… AnÃ¡lisis completo. Herramienta OSINT finalizada.")
